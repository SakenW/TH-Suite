# MC L10n ä»£ç åˆ†ææŠ¥å‘Š

**åˆ†ææ—¥æœŸ**: 2025-09-06  
**ç‰ˆæœ¬**: v5.0 â†’ v6.0  
**åˆ†æäºº**: Development Team

## ğŸ“Š ä»£ç ç»Ÿè®¡

### æ•´ä½“è§„æ¨¡
- **Pythonæ–‡ä»¶æ€»æ•°**: 121ä¸ª
- **ç›®å½•æ·±åº¦**: 3-4å±‚
- **ä»£ç è¡Œæ•°**: çº¦15,000è¡Œï¼ˆä¼°ç®—ï¼‰

## ğŸ”´ ä¸¥é‡é—®é¢˜

### 1. å¤§é‡é‡å¤çš„Scannerå®ç°ï¼ˆ23ä¸ªç›¸å…³æ–‡ä»¶ï¼‰

#### é‡å¤çš„æ‰«æå™¨å®ç°
```
æ ¹ç›®å½•ä¸‹çš„æ‰«æå™¨ï¼ˆéœ€è¦åˆ é™¤/åˆå¹¶ï¼‰:
- ddd_scanner.py          # DDDç‰ˆæœ¬æ‰«æå™¨
- simple_scanner.py       # ç®€å•æ‰«æå™¨
- fixed_scanner.py        # ä¿®å¤ç‰ˆæ‰«æå™¨
- full_scanner.py         # å®Œæ•´æ‰«æå™¨
- upsert_scanner.py       # UPSERTç‰ˆæœ¬
- enterprise_upsert_scanner.py  # ä¼ä¸šç‰ˆUPSERT
- scanner_service.py      # æ‰«ææœåŠ¡
- test_real_scan.py       # æµ‹è¯•æ‰«æ

infrastructure/scanners/ä¸‹:
- base_scanner.py
- folder_scanner.py
- jar_scanner.py

src/mc_l10n/infrastructure/scanners/ä¸‹ï¼ˆæ–°ç‰ˆæœ¬ï¼‰:
- mod_scanner.py
- project_scanner.py

database/ä¸‹:
- scan_service.py         # æ•°æ®åº“é›†æˆçš„æ‰«ææœåŠ¡ï¼ˆæœ€æ–°ï¼‰
```

**åˆ†æ**: æœ‰è‡³å°‘8ä¸ªä¸åŒç‰ˆæœ¬çš„æ‰«æå™¨å®ç°ï¼ŒåŠŸèƒ½é‡å ä¸¥é‡ã€‚

### 2. é‡å¤çš„ç›®å½•ç»“æ„

å­˜åœ¨ä¸¤å¥—å¹¶è¡Œçš„ä»£ç ç»“æ„ï¼š

#### æ—§ç»“æ„ï¼ˆæ ¹ç›®å½•ï¼‰
```
backend/
â”œâ”€â”€ domain/
â”œâ”€â”€ infrastructure/
â”œâ”€â”€ application/
â””â”€â”€ api/
```

#### æ–°ç»“æ„ï¼ˆsrcç›®å½•ï¼‰
```
backend/src/mc_l10n/
â”œâ”€â”€ domain/
â”œâ”€â”€ infrastructure/
â”œâ”€â”€ application/
â”œâ”€â”€ api/
â””â”€â”€ adapters/
```

**é—®é¢˜**: ä»£ç åˆ†æ•£åœ¨ä¸¤ä¸ªä½ç½®ï¼Œé€ æˆæ··ä¹±ã€‚

### 3. å¤šä¸ªæ•°æ®åº“åˆå§‹åŒ–è„šæœ¬

```
- init_db.py              # åŸå§‹ç‰ˆæœ¬
- init_db_ddd.py          # DDDç‰ˆæœ¬
- init_clean_db.py        # æ¸…ç†ç‰ˆæœ¬
- database/init_local_db.py  # æœ¬åœ°æ•°æ®åº“ç‰ˆæœ¬ï¼ˆæœ€æ–°ï¼‰
```

**é—®é¢˜**: 4ä¸ªä¸åŒçš„åˆå§‹åŒ–è„šæœ¬ï¼Œä¸æ¸…æ¥šè¯¥ä½¿ç”¨å“ªä¸ªã€‚

### 4. é‡å¤çš„æ•°æ®åº“æŸ¥çœ‹å·¥å…·

```
tools/db_viewer/
- db_web_advanced.py      # é«˜çº§WebæŸ¥çœ‹å™¨
- db_web_viewer.py        # WebæŸ¥çœ‹å™¨
- view_database.py        # åŸºç¡€æŸ¥çœ‹å™¨
- view_db_simple.py       # ç®€å•æŸ¥çœ‹å™¨
```

**é—®é¢˜**: 4ä¸ªåŠŸèƒ½ç›¸ä¼¼çš„æ•°æ®åº“æŸ¥çœ‹å·¥å…·ã€‚

## ğŸŸ¡ æ¶æ„é—®é¢˜

### 1. èŒè´£ä¸æ¸…
- Scanneræ—¢è´Ÿè´£æ‰«æï¼Œåˆè´Ÿè´£æ•°æ®åº“æ“ä½œ
- Domainå±‚åŒ…å«äº†åŸºç¡€è®¾æ–½ä»£ç 
- ç¼ºå°‘ç»Ÿä¸€çš„æœåŠ¡å…¥å£

### 2. ç¼ºå°‘æŠ½è±¡å±‚
- ç›´æ¥æ“ä½œSQLiteï¼Œæ²¡æœ‰RepositoryæŠ½è±¡
- æ²¡æœ‰ç»Ÿä¸€çš„é”™è¯¯å¤„ç†
- ç¼ºå°‘ä¾èµ–æ³¨å…¥

### 3. ä»£ç è€¦åˆ
- ä¸šåŠ¡é€»è¾‘ä¸æŠ€æœ¯å®ç°æ··åˆ
- ç¡¬ç¼–ç çš„æ–‡ä»¶è·¯å¾„
- å…¨å±€å˜é‡ä½¿ç”¨

## ğŸŸ¢ è‰¯å¥½å®è·µï¼ˆéœ€è¦ä¿ç•™ï¼‰

### 1. database/ç›®å½•ä¸‹çš„æ–°å®ç°
```
database/
â”œâ”€â”€ local_database_manager.py  # å®Œå–„çš„æ•°æ®åº“ç®¡ç†
â”œâ”€â”€ scan_service.py            # é›†æˆçš„æ‰«ææœåŠ¡
â”œâ”€â”€ sync_service.py            # åŒæ­¥æœåŠ¡
â”œâ”€â”€ offline_tracker.py         # ç¦»çº¿è·Ÿè¸ª
â”œâ”€â”€ database_api.py            # APIæ¥å£
â””â”€â”€ db_cli.py                  # CLIå·¥å…·
```
**è¯„ä»·**: è¿™æ˜¯æœ€æ–°æœ€å®Œæ•´çš„å®ç°ï¼Œåº”è¯¥ä½œä¸ºé‡æ„åŸºç¡€ã€‚

### 2. DDDæ¨¡å‹å®šä¹‰
```
domain/models/
â”œâ”€â”€ aggregates/               # èšåˆæ ¹å®šä¹‰è‰¯å¥½
â”œâ”€â”€ entities/                 # å®ä½“å®šä¹‰æ¸…æ™°
â””â”€â”€ value_objects/           # å€¼å¯¹è±¡å®Œæ•´
```
**è¯„ä»·**: é¢†åŸŸæ¨¡å‹è®¾è®¡è‰¯å¥½ï¼Œå¯ä»¥ä¿ç•™å¹¶ä¼˜åŒ–ã€‚

## ğŸ“ åˆ é™¤æ¸…å•

### å¿…é¡»åˆ é™¤çš„æ–‡ä»¶ï¼ˆ42ä¸ªï¼‰

#### æ‰«æå™¨ç›¸å…³ï¼ˆ15ä¸ªï¼‰
```bash
# æ ¹ç›®å½•ä¸‹çš„æ—§æ‰«æå™¨
rm ddd_scanner.py
rm simple_scanner.py
rm fixed_scanner.py
rm full_scanner.py
rm upsert_scanner.py
rm enterprise_upsert_scanner.py
rm scanner_service.py
rm test_real_scan.py

# æ—§çš„infrastructureæ‰«æå™¨
rm -rf infrastructure/scanners/  # æ•´ä¸ªç›®å½•

# æ—§çš„æµ‹è¯•
rm tests/test_mod_scanner.py
rm tests/test_project_scanner.py
rm tests/test_scan_service.py
```

#### æ•°æ®åº“åˆå§‹åŒ–ï¼ˆ3ä¸ªï¼‰
```bash
rm init_db.py
rm init_db_ddd.py
rm init_clean_db.py
# ä¿ç•™ database/init_local_db.py
```

#### æ•°æ®åº“å·¥å…·ï¼ˆ3ä¸ªï¼‰
```bash
rm tools/db_viewer/db_web_viewer.py
rm tools/db_viewer/view_database.py
rm tools/db_viewer/view_db_simple.py
# ä¿ç•™ db_web_advanced.py
```

#### æ£€æŸ¥å’Œæµ‹è¯•æ–‡ä»¶ï¼ˆ5ä¸ªï¼‰
```bash
rm check_db.py
rm test_real_scan.py
rm init_db_ddd.py
rm test_data.py  # å¦‚æœå­˜åœ¨
```

#### é‡å¤çš„srcç›®å½•ï¼ˆæ•´ä¸ªç›®å½•ï¼‰
```bash
# éœ€è¦è¯„ä¼°åå†³å®šæ˜¯ä¿ç•™srcè¿˜æ˜¯æ ¹ç›®å½•ç»“æ„
# å»ºè®®ï¼šå°†src/mc_l10n/çš„å†…å®¹åˆå¹¶åˆ°æ ¹ç›®å½•
```

## ğŸ”„ åˆå¹¶æ¸…å•

### éœ€è¦åˆå¹¶çš„åŠŸèƒ½

1. **æ‰«æå™¨åˆå¹¶æ–¹æ¡ˆ**
   - åŸºç¡€åŠŸèƒ½ï¼šä» `database/scan_service.py` 
   - TOMLè§£æï¼šä» `fixed_scanner.py`
   - è¯­è¨€æå–ï¼šä» `full_scanner.py`
   - å¹¶å‘å¤„ç†ï¼šä» `enterprise_upsert_scanner.py`

2. **æ•°æ®åº“åˆå§‹åŒ–åˆå¹¶**
   - ä½¿ç”¨ `database/init_local_db.py` ä½œä¸ºå”¯ä¸€åˆå§‹åŒ–è„šæœ¬
   - æ•´åˆå…¶ä»–è„šæœ¬çš„æœ‰ç”¨åŠŸèƒ½

3. **APIè·¯ç”±åˆå¹¶**
   - `api/routes/` å’Œ `src/mc_l10n/api/` åˆå¹¶
   - ç»Ÿä¸€è·¯ç”±å®šä¹‰

## ğŸ—ï¸ é‡æ„å»ºè®®

### 1. ç»Ÿä¸€ç›®å½•ç»“æ„
```
apps/mc_l10n/backend/
â”œâ”€â”€ adapters/           # å¤–éƒ¨æ¥å£é€‚é…å™¨
â”œâ”€â”€ application/        # åº”ç”¨å±‚
â”œâ”€â”€ domain/            # é¢†åŸŸå±‚ï¼ˆä¿ç•™ç°æœ‰ï¼‰
â”œâ”€â”€ infrastructure/    # åŸºç¡€è®¾æ–½å±‚
â”œâ”€â”€ database/          # æ•°æ®åº“æ¨¡å—ï¼ˆä¿ç•™ï¼‰
â”œâ”€â”€ main.py           # ç»Ÿä¸€å…¥å£
â””â”€â”€ tests/            # æ‰€æœ‰æµ‹è¯•
```

### 2. åˆ›å»ºé€šç”¨åŒ…
å°†å¯å¤ç”¨çš„ç»„ä»¶ç§»åŠ¨åˆ° `packages/common/`:
- åŸºç¡€Repositoryç±»
- ç¼“å­˜ç®¡ç†å™¨
- æ–‡ä»¶æ“ä½œå·¥å…·
- æ‰«ææ¡†æ¶åŸºç±»

### 3. å®ç°å…­è¾¹å½¢æ¶æ„
- å®šä¹‰ç«¯å£ï¼ˆæ¥å£ï¼‰
- å®ç°é€‚é…å™¨
- åˆ†ç¦»ä¸šåŠ¡é€»è¾‘å’ŒæŠ€æœ¯ç»†èŠ‚

## ğŸ“ˆ ä¼˜åŒ–æ”¶ç›Šé¢„ä¼°

| æŒ‡æ ‡ | å½“å‰ | ä¼˜åŒ–å | æ”¹å–„ |
|------|------|--------|------|
| ä»£ç æ–‡ä»¶æ•° | 121 | ~70 | -42% |
| é‡å¤ä»£ç  | ~40% | <5% | -87% |
| ä»£ç è¡Œæ•° | ~15,000 | ~8,000 | -46% |
| ç»´æŠ¤å¤æ‚åº¦ | é«˜ | ä½ | â¬‡ï¸â¬‡ï¸ |
| æµ‹è¯•è¦†ç›–ç‡ | ~20% | >80% | â¬†ï¸â¬†ï¸â¬†ï¸ |

## ğŸ¯ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. **ç«‹å³æ‰§è¡Œ**ï¼šåˆ é™¤ä¸Šè¿°42ä¸ªæ–‡ä»¶
2. **Phase 1.2**ï¼šè¯¦ç»†åˆ†æéœ€è¦ä¿ç•™çš„ä»£ç 
3. **Phase 1.3**ï¼šåˆ›å»ºè¯¦ç»†çš„é‡æ„æ‰§è¡Œè®¡åˆ’
4. **Phase 2**ï¼šå¼€å§‹åˆ›å»ºpackages/common

## ğŸ“Š é£é™©è¯„ä¼°

- **ä½é£é™©**ï¼šåˆ é™¤é‡å¤æ–‡ä»¶ï¼Œä¿ç•™æœ€æ–°å®ç°
- **ä¸­é£é™©**ï¼šåˆå¹¶åŠŸèƒ½å¯èƒ½å¼•å…¥bug
- **éœ€è¦æµ‹è¯•**ï¼šç¡®ä¿åˆ é™¤åç³»ç»Ÿä»èƒ½æ­£å¸¸è¿è¡Œ

---

**ç»“è®º**: ä»£ç åº“å­˜åœ¨ä¸¥é‡çš„é‡å¤é—®é¢˜ï¼Œéœ€è¦ç«‹å³æ¸…ç†ã€‚å»ºè®®ä¿ç•™database/ç›®å½•ä¸‹çš„æœ€æ–°å®ç°ï¼Œåˆ é™¤æ‰€æœ‰æ—§ç‰ˆæœ¬ï¼Œç„¶ååŸºäºå…­è¾¹å½¢æ¶æ„é‡æ–°ç»„ç»‡ä»£ç ã€‚